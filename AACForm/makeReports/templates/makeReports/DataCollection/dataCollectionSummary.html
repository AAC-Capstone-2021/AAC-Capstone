{% extends 'base.html' %}
{% load bootstrap4 %}
{% block content %}
<h3>Data Collection and Analysis Summary</h3>
<table class="table">
    <tbody>
        <tr>
            <td>Measure</td>
            <td>Data Collection Date Range</td>
            <td>Number of Students Assessed</td>
            <td>Number of Students Who Met/<br>Exceeded Threshold Proficiency</td>
            <td>Subassessment Options</td>
            <td>Overall Options</td>
        </tr>
        {% for assessment in assessment_data_dict.assessments %}
        <tr>
            <td>{{assessment.slo_text}} : {{assessment.assessment_text}}</td>
            <td>{{assessment.data_range}}</td>
            <td>{{assessment.num_students_assessed}}</td>
            <td>
                {% if assessment.subassessments_len > 0 %}
                    {% for subassessment in assessment.subassessments %}
                        {% if forloop.last %}
                            {{subassessment.0}}: {{subassessment.1}}%
                        {% else %}
                            {{subassessment.0}}: {{subassessment.1}}% <br>
                        {% endif %}
                    {% endfor %}
                {% else %}
                    {{assessment.overall_proficient}}%
                {% endif %}
            </td>
            <td>
                {% if assessment.subassessments_len > 0 %}
                    {% for subassessment in assessment.subassessments %}
                        {% if forloop.last %}
                            <a type="button" title="Edit subassessment" class="btn btn-primary" href="{% url 'makeReports:edit-subassessment' report=rpt.pk pk=subassessment.2%}"> ✎</a>
                            <a type="button" title="Delete subassessment" class="btn btn-primary" href="{% url 'makeReports:delete-subassessment' report=rpt.pk pk=assessment.assessment_data_id %}"> 🗑️</a>
                        {% else %}
                            <a type="button" title="Edit subassessment" class="btn btn-primary" href="{% url 'makeReports:edit-subassessment' report=rpt.pk pk=subassessment.2%}"> ✎</a>
                            <a type="button" title="Delete subassessment" class="btn btn-primary" href="{% url 'makeReports:delete-subassessment' report=rpt.pk pk=assessment.assessment_data_id %}"> 🗑️</a> <br>
                        {% endif %}
                    {% endfor %}
                {% else %}
                    (No Subassessments)
                {% endif %}
            </td>
            <td>
                {% if assessment.data_range == None %}
                    <a type="button" class="btn btn-primary" href="{% url 'makeReports:add-data-collection' report=rpt.pk assessment=assessment.assessment_id %}"> Add Assessment Data</a>
                {% else %}
                    <a type="button" title="Add subassessment" class="btn btn-primary" href="{% url 'makeReports:add-subassessment' report=rpt.pk assessment=assessment.assessment_id%}"> 📝</a>
                    <a type="button" title="Edit data for measure" class="btn btn-primary" href="{% url 'makeReports:edit-data-collection' report=rpt.pk dataCollection=assessment.assessment_data_id%}"> ✎</a>
                    <a type="button" title="Delete data for measure" class="btn btn-primary" href="{% url 'makeReports:delete-data-collection' report=rpt.pk pk=assessment.assessment_data_id %}"> 🗑️</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}